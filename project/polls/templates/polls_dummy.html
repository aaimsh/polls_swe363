<DOCTYPE!>
<html>
	<head>
		<title>Polls</title>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

        {% include 'head.html'%}
	</head>


	<body>
	    
    {% include 'nav.html' %}

    <div class="left-side">
        <div class="list-group">
                {% block content %}
                    {% if polls %}
                        {% for poll in polls %}
                            <a class="list-group-item" onclick="show({{poll.id }})">{{ poll.question }}</a>
                        {% endfor %}
                    {% endif %}
                {% endblock %}
                <a class="btn btn-seccess list-group-item" href="{% url 'polls:create-poll' %}">Add poll</a>
            </div>
    </div>

	<div class="container">

		<div class="poll-header">
			<h3>Results</h3>
		</div>

		<div class="content">


			{% block content1 %}
			    {% if polls %}
			        {% for poll in polls %}
			        	<div class="poll-result">
							<p>Vote link: localhost:8000{% url 'polls:vote' poll.id%}</p>
							<ul class="opstions-result">
								{% for choice in poll.choice_set.all %}
									<li>{{ choice.choice }} -- {{ choice.vote }} vote{{ choice.vote|pluralize }}</li>

								{% endfor %}
							</ul>
							<div class="chart-result" id="chart-{{poll.id}}"></div>
						</div>
					{% endfor %}
			    {% else %}
			    	<p>Nothing to view</p>
			    {% endif %}
			{% endblock %}


		</div>

	</div>

	


			
	<footer>
							
		<ul>
			<span>Team members</span>
			<li>AMER ALHOMAIDHI</li>
			<li>ABDULAULAH ALHUSIEN</li>
		</ul>

	</footer>

<script type="text/javascript">
      google.charts.load("current", {packages:["corechart"]});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart(data) {


        var options = {
          title: 'votes',
          pieHole: 0.4,
        };

        var options = {
               'width': 300,
               'height': 200,
               'chartArea': {'width': '100%', 'height': '80%'},
               'legend': {'position': 'bottom'},
                'pieHole': 0.4
    };
        {% block conten3 %}
            {% for poll in polls %}
            var data_{{ poll.id }} = google.visualization.arrayToDataTable([
                ['option ', 'votes'],
                    {% for choice in poll.choice_set.all %}
                    ['{{ choice }}', {{ choice.vote }} ],
                {% endfor %}
            ]);
            {% endfor %}
        {% for poll in polls %}
            var chart_{{ poll.id }} = new google.visualization.PieChart(document.getElementById('chart-{{ poll.id }}'));
            chart_{{ poll.id }}.draw(data_{{ poll.id }}, options);
        {% endfor %}

      }


</script>
{% endblock %}

	</body>
</html>
